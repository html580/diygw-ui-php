import{u as N,b as S}from"./vue-router-17193735.js";import{v as U}from"./vue-i18n-c25bb36f.js";import{a as B}from"./js-cookie-edb2da2a.js";import{u as P,p as $,s as D,S as y,t as F,w as j,N as A,_ as E}from"./index-5e2104fc.js";import{a as O}from"./formatTime-29ac8c52.js";import{s as z}from"./pinia-cd41b998.js";import{a as J}from"./element-plus-28d330eb.js";import{d as L,e as w,_,j as M,ag as n,o as G,O as H,P as o,V as t,a as I,J as K,U as Q}from"./@vue-110897a1.js";import"./@intlify-d9393dcf.js";import"./vue-cc729cf0.js";import"./@element-plus-ff880098.js";import"./nprogress-28073a82.js";import"./axios-28bc18a3.js";import"./lodash-9a19cd29.js";import"./mitt-f7ef348c.js";import"./@wangeditor-231513dc.js";import"./vue-grid-layout-2853dde1.js";import"./lodash-es-21c98b27.js";import"./@vueuse-0a258a1c.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-816b3f93.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-72afddb3.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-432baded.js";const W=L({__name:"account",setup(X){const{t:f}=U.useI18n(),h=P(),{themeConfig:k}=z(h),c=N(),g=S(),v=w(),a=_({username:"",password:""}),x=_({username:[{required:!0,message:f("message.account.accountPlaceholder1"),trigger:"blur"}],password:[{required:!0,message:f("message.account.accountPlaceholder2"),trigger:"blur"}]}),m=w(!1),p=_({signIn:!1}),b=M(()=>O(new Date)),C=async()=>{v.value.validate(s=>{s&&$("/admin/login/login",{username:a.username,password:a.password}).then(async e=>{p.signIn=!0;const r={userId:e.data.userId,userName:a.username,nickname:e.data.nickname,avatar:e.data.avatar||D(e.data.username),time:new Date().getTime(),roles:e.data.roles,authBtnList:e.data.auths};y.set("token",e.data.token),y.set("userInfo",r),p.signIn=!0,B.set("userName",a.username),k.value.isRequestRoutes?await j():await F(),R()})})},R=()=>{var r,l,u,i;let s=b.value;(r=c.query)!=null&&r.redirect?g.push({path:(l=c.query)==null?void 0:l.redirect,query:Object.keys((u=c.query)==null?void 0:u.params).length>0?JSON.parse((i=c.query)==null?void 0:i.params):""}):g.push("/"),p.signIn=!0;const e=f("message.signInText");J.success(`${s}ï¼Œ${e}`),A.start()};return(s,e)=>{const r=n("ele-User"),l=n("el-icon"),u=n("el-input"),i=n("el-form-item"),T=n("ele-Unlock"),V=n("el-button"),q=n("el-form");return G(),H(q,{size:"large",ref_key:"loginFormRef",ref:v,model:a,class:"login-content-form",rules:x},{default:o(()=>[t(i,{class:"login-animation1",prop:"username"},{default:o(()=>[t(u,{type:"text",placeholder:s.$t("message.account.accountPlaceholder1"),modelValue:a.username,"onUpdate:modelValue":e[0]||(e[0]=d=>a.username=d),clearable:"",autocomplete:"off"},{prefix:o(()=>[t(l,{class:"el-input__icon"},{default:o(()=>[t(r)]),_:1})]),_:1},8,["placeholder","modelValue"])]),_:1}),t(i,{class:"login-animation2",prop:"password"},{default:o(()=>[t(u,{type:m.value?"text":"password",placeholder:s.$t("message.account.accountPlaceholder2"),modelValue:a.password,"onUpdate:modelValue":e[2]||(e[2]=d=>a.password=d),clearable:"",autocomplete:"off"},{prefix:o(()=>[t(l,{class:"el-input__icon"},{default:o(()=>[t(T)]),_:1})]),suffix:o(()=>[I("i",{class:K(["iconfont el-input__icon login-content-password",m.value?"icon-yincangmima":"icon-xianshimima"]),onClick:e[1]||(e[1]=d=>m.value=!m.value)},null,2)]),_:1},8,["type","placeholder","modelValue"])]),_:1}),t(i,{class:"login-animation4"},{default:o(()=>[t(V,{type:"primary",class:"login-content-submit",round:"",onClick:C,loading:p.signIn},{default:o(()=>[I("span",null,Q(s.$t("message.account.accountBtnText")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])}}});const Ce=E(W,[["__scopeId","data-v-fb2ac1a1"]]);export{Ce as default};
