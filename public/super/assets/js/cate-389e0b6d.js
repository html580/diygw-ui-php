import{_ as W,g as w,h as Z,i as G,l as H,j as x,k as J,p as K,m as L}from"./index-5e2104fc.js";import{b as X,u as Y}from"./vue-router-17193735.js";import{a as f,E as ee}from"./element-plus-28d330eb.js";import{h as te,e as k,_ as ae,$ as oe,i as le,Z as ie,ag as n,aq as ne,o as D,c as se,a as r,V as a,P as l,T as s,Q as de,O as R,S as re,u as d,D as me,d as ce,bi as pe,bg as ue}from"./@vue-110897a1.js";import"./pinia-cd41b998.js";import"./vue-i18n-c25bb36f.js";import"./@intlify-d9393dcf.js";import"./vue-cc729cf0.js";import"./js-cookie-edb2da2a.js";import"./@element-plus-ff880098.js";import"./nprogress-28073a82.js";import"./axios-28bc18a3.js";import"./lodash-9a19cd29.js";import"./mitt-f7ef348c.js";import"./@wangeditor-231513dc.js";import"./vue-grid-layout-2853dde1.js";import"./lodash-es-21c98b27.js";import"./@vueuse-0a258a1c.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-816b3f93.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-72afddb3.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-432baded.js";const _e=p=>(pe("data-v-d7029ed5"),p=p(),ue(),p),fe={class:"container"},ge={class:"el-card is-always-shadow diygw-col-24 admintable-clz"},he={class:"el-card__body"},ye={class:"mb8"},ve={class:"flex diygw-col-24 parentId-clz"},we={class:"flex diygw-col-24 title-clz"},De={class:"dialog-footer"},be=_e(()=>r("div",{class:"clearfix"},null,-1)),Fe=ce({name:"cate"}),Ie=Object.assign(Fe,{setup(p){const{proxy:m}=te();X();const S=Y();k(S.query);const e=ae({tet:"这是皮皮的测试",loading:!0,ids:[],single:!0,multiple:!0,title:"",total:0,tableData:[],isShowDialog:!1,saveloading:!1,editFormData:{parentIdDatas:[],parentIdRowDatas:[]},queryParams:{pageNum:1,pageSize:1e6},queryParamsRules:{},editForm:{id:void 0,parentId:void 0,title:""},editFormRules:{}}),{tet:Ce,editFormData:B,queryParams:xe,multiple:ke,tableData:Re,loading:Se,title:Be,single:Ve,total:Ee,isShowDialog:g,editForm:u,ids:Pe,saveloading:Me}=oe(e),b=k(null),V=w(e.editForm),F=t=>{t.id&&t.id!=null&&t.id!=0?e.editForm=L(t,e.editForm):P(),e.isShowDialog=!0,e.saveloading=!1},h=t=>{m.mittBus.emit("onEditAdmintableModule",t),e.isShowDialog=!1},E=()=>{const t=d(b);t&&t.validate(o=>{o?(e.saveloading=!0,e.editForm.id!=null&&e.editForm.id!=0?Z("/cms/menu",e.editForm).then(()=>{m.mittBus.emit("onEditFormParentId"),f.success("修改成功"),e.saveloading=!1,h(e.editForm)}).finally(()=>{e.saveloading=!1}):G("/cms/menu",e.editForm).then(()=>{m.mittBus.emit("onEditFormParentId"),f.success("新增成功"),e.saveloading=!1,h(e.editForm)}).finally(()=>{e.saveloading=!1})):f.error("验证未通过！")})},P=()=>{e.editForm=w(V)};w(e.queryParams);const y=()=>{e.loading=!0,H("/cms/menu",e.queryParams).then(t=>{e.tableData=x(t.rows,"id","parentId","children"),e.total=t.total,e.loading=!1})},M=t=>{t=[],e.title="添加CRUD表格",F(t)},U=t=>{e.title="修改CRUD表格",F(t)},I=t=>{const o=t.id||e.ids;ee({message:"是否确认删除选中的CRUD表格?",title:"警告",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return J("/cms/menu",o).then(()=>{y(),f.success("删除成功")})})},q=t=>{e.ids=t.map(o=>o.id),e.single=t.length!=1,e.multiple=!t.length},z=async()=>{};return le(async()=>{await z();function t(){K("/cms/menu/list",{pageSize:1e5}).then(o=>{e.editFormData.parentIdRowDatas=o.rows,o.rows.unshift({id:0,title:"顶级分类"}),e.editFormData.parentIdDatas=x(o.rows,"id","parentId","children")})}t(),m.mittBus.on("onEditFormParentId",()=>{t()}),y(),m.mittBus.on("onEditAdmintableModule",()=>{y()})}),ie(()=>{m.mittBus.off("onEditAdmintableModule")}),(t,o)=>{const _=n("SvgIcon"),c=n("el-button"),v=n("el-table-column"),T=n("el-table"),N=n("el-cascader"),C=n("el-form-item"),A=n("el-input"),O=n("el-form"),$=n("el-dialog"),j=ne("loading");return D(),se("div",fe,[r("div",ge,[r("div",he,[r("div",ye,[a(c,{type:"primary",plain:"",onClick:M},{default:l(()=>[a(_,{name:"ele-Plus"}),s("新增 ")]),_:1}),s(),a(c,{type:"danger",plain:"",disabled:e.multiple,onClick:I},{default:l(()=>[a(_,{name:"ele-Delete"}),s("删除 ")]),_:1},8,["disabled"])]),de((D(),R(T,{onSelectionChange:q,"row-key":"id","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"},data:e.tableData,stripe:"",border:"","current-row-key":"id","empty-text":"没有数据",style:{width:"100%"}},{default:l(()=>[a(v,{type:"selection",width:"55",align:"center"}),a(v,{label:"分类名",prop:"title"}),a(v,{label:"操作",align:"center",fixed:"right",width:"180"},{default:l(i=>[a(c,{type:"primary",plain:"",size:"small",onClick:Q=>U(i.row)},{default:l(()=>[a(_,{name:"ele-Edit"}),s("修改 ")]),_:2},1032,["onClick"]),s(),i.row.id!=0?(D(),R(c,{key:0,type:"danger",plain:"",size:"small",onClick:Q=>I(i.row)},{default:l(()=>[a(_,{name:"ele-Delete"}),s("删除 ")]),_:2},1032,["onClick"])):re("",!0)]),_:1})]),_:1},8,["data"])),[[j,e.loading]])]),a($,{modelValue:d(g),"onUpdate:modelValue":o[2]||(o[2]=i=>me(g)?g.value=i:null),"destroy-on-close":"",width:"800px",title:"CRUD表格",draggable:"",center:""},{footer:l(()=>[r("div",De,[a(c,{onClick:h},{default:l(()=>[s(" 取 消 ")]),_:1}),s(),a(c,{type:"primary",onClick:E,loading:e.saveloading},{default:l(()=>[s(" 保 存 ")]),_:1},8,["loading"])])]),default:l(()=>[a(O,{class:"flex flex-direction-row flex-wrap",model:e.editForm,rules:e.editFormRules,ref_key:"editFormRef",ref:b,"label-width":"80px"},{default:l(()=>[r("div",ve,[a(C,{prop:"parentId",class:"diygw-el-rate",label:"父结点"},{default:l(()=>[a(N,{options:d(B).parentIdDatas,class:"w100",modelValue:d(u).parentId,"onUpdate:modelValue":o[0]||(o[0]=i=>d(u).parentId=i),props:{label:"title",value:"id",checkStrictly:!0,emitPath:!1},clearable:"",filterable:"",placeholder:"请选择","show-all-levels":!1},null,8,["options","modelValue"])]),_:1})]),r("div",we,[a(C,{class:"diygw-el-rate",prop:"title",label:"标题"},{default:l(()=>[a(A,{type:"text",placeholder:"请输入提示",modelValue:d(u).title,"onUpdate:modelValue":o[1]||(o[1]=i=>d(u).title=i)},null,8,["modelValue"])]),_:1})])]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])]),be])}}}),st=W(Ie,[["__scopeId","data-v-d7029ed5"]]);export{st as default};
