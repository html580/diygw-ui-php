import{d as ee,h as te,e as ae,_ as oe,f as le,i as ne,Z as se,ag as s,aq as re,o as g,c as C,V as t,P as l,a as y,u as P,a9 as k,F as ie,a8 as de,O as q,T as p,Q as V,W as ue}from"./@vue-110897a1.js";import{M as pe}from"./@element-plus-ff880098.js";import me from"./editModule-6368a168.js";import{l as I,j as ce,z as _e,k as fe,s as he,_ as ge}from"./index-5e2104fc.js";import{E as N,a as D}from"./element-plus-28d330eb.js";import"./pinia-cd41b998.js";import"./vue-router-17193735.js";import"./vue-i18n-c25bb36f.js";import"./@intlify-d9393dcf.js";import"./vue-cc729cf0.js";import"./js-cookie-edb2da2a.js";import"./nprogress-28073a82.js";import"./axios-28bc18a3.js";import"./lodash-9a19cd29.js";import"./mitt-f7ef348c.js";import"./@wangeditor-231513dc.js";import"./vue-grid-layout-2853dde1.js";import"./lodash-es-21c98b27.js";import"./@vueuse-0a258a1c.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-816b3f93.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-72afddb3.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-432baded.js";const ye={class:"system-user-container container"},ve={class:"head-container"},be={class:"head-container"},xe={class:"mb8"},we=ee({__name:"index",setup(Ce){const{proxy:m}=te(),v=ae(),e=oe({tableData:[],total:0,loading:!1,postOptions:[],defaultProps:{children:"children",label:"deptName"},sexOptions:[],roleOptions:[],statusOptions:[],deptName:void 0,single:!0,multiple:!0,ids:[],title:"",deptOptions:void 0,queryParams:{pageNum:1,pageSize:10,username:void 0,phone:void 0,status:void 0,deptId:void 0}});le(()=>e.deptName,a=>{m.$refs.tree.filter(a)});const b=async()=>{e.loading=!0,I("/sys/user",e.queryParams).then(a=>{a.code!=200&&(e.loading=!1),e.tableData=a.rows,e.total=a.total,e.loading=!1})},S=a=>{e.ids=a.map(n=>n.userId),e.single=a.length!=1,e.multiple=!a.length},i=async()=>{e.queryParams.pageNum=1,await b()},B=async()=>{e.queryParams.pageNum=1,e.queryParams.pageSize=10,e.queryParams.username="",e.queryParams.phone="",e.queryParams.status="",e.queryParams.deptId=0,i()},O=()=>{e.title="添加用戶",v.value.openDialog(null)},z=a=>{e.title="修改用户",v.value.openDialog(a)},U=async()=>{I("/sys/dept",{}).then(a=>{e.deptOptions=ce(a.rows,"deptId","parentId","children")})},E=a=>{let n=a.status==="0"?"启用":"停用";N({title:"警告",message:'确认要"'+n+'""'+a.username+'"用户吗?',showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",beforeClose:(c,w,_)=>{if(c==="confirm")return _e("/sys/user",{userId:a.userId,status:a.status}).then(()=>{D.success(n+"成功"),_()});_()}}).catch(()=>{a.status=a.status==="0"?"1":"0"})},x=a=>{const n=a.userId||e.ids;N({message:'是否确认删除用户编号为"'+n+'"的数据项?',title:"警告",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){return fe("/sys/user",n).then(()=>{i(),D.success("删除成功")})})},T=a=>{e.queryParams.pageSize=a,i()},M=a=>{e.queryParams.pageNum=a,i()},F=(a,n)=>a?n.deptName.indexOf(a)!==-1:!0,L=a=>{e.queryParams.deptId=a.deptId,b(),e.queryParams.deptId=0},$=()=>{},K=a=>m.selectDictLabel(e.sexOptions,a.sex);return ne(()=>{b(),U(),e.statusOptions=m.getDict("sys_normal_disable"),m.getDicts("sys_user_sex").then(a=>{e.sexOptions=a.rows}),m.mittBus.on("onEditUserModule",()=>{i()})}),se(()=>{m.mittBus.off("onEditUserModule")}),(a,n)=>{const c=s("el-input"),w=s("el-tree"),_=s("el-col"),f=s("el-form-item"),Q=s("el-option"),R=s("el-select"),d=s("SvgIcon"),u=s("el-button"),j=s("el-form"),r=s("el-table-column"),A=s("el-image"),H=s("el-switch"),W=s("el-table"),Z=s("el-divider"),G=s("el-pagination"),J=s("el-row"),X=s("el-card"),Y=re("loading");return g(),C("div",ye,[t(X,{shadow:"always"},{default:l(()=>[t(J,{gutter:20},{default:l(()=>[t(_,{span:4,xs:24},{default:l(()=>[y("div",ve,[t(c,{modelValue:e.deptName,"onUpdate:modelValue":n[0]||(n[0]=o=>e.deptName=o),placeholder:"请输入部门名称",clearable:"","prefix-icon":P(pe),style:{"margin-bottom":"20px"}},null,8,["modelValue","prefix-icon"])]),y("div",be,[t(w,{data:e.deptOptions,props:e.defaultProps,"node-key":"deptId","expand-on-click-node":!1,"filter-node-method":F,ref:"tree","default-expand-all":"",onNodeClick:L},null,8,["data","props"])])]),_:1}),t(_,{span:20,xs:24},{default:l(()=>[t(j,{model:e.queryParams,ref:"queryForm",inline:!0,"label-width":"78px"},{default:l(()=>[t(f,{label:"用户名称",prop:"username"},{default:l(()=>[t(c,{placeholder:"用户名称模糊查询",clearable:"",onKeyup:k(i,["enter"]),style:{width:"240px"},modelValue:e.queryParams.username,"onUpdate:modelValue":n[1]||(n[1]=o=>e.queryParams.username=o)},null,8,["modelValue"])]),_:1}),t(f,{label:"手机号码",prop:"phone"},{default:l(()=>[t(c,{modelValue:e.queryParams.phone,"onUpdate:modelValue":n[2]||(n[2]=o=>e.queryParams.phone=o),placeholder:"请输入手机号码",clearable:"",style:{width:"240px"},onKeyup:k(i,["enter"])},null,8,["modelValue"])]),_:1}),t(f,{label:"状态",prop:"status"},{default:l(()=>[t(R,{modelValue:e.queryParams.status,"onUpdate:modelValue":n[3]||(n[3]=o=>e.queryParams.status=o),placeholder:"用户状态",clearable:"",style:{width:"240px"}},{default:l(()=>[(g(!0),C(ie,null,de(e.statusOptions,o=>(g(),q(Q,{key:o.dictValue,label:o.dictLabel,value:o.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(f,null,{default:l(()=>[t(u,{type:"primary",onClick:i},{default:l(()=>[t(d,{name:"ele-Search"}),p(" 搜索 ")]),_:1}),t(u,{onClick:B},{default:l(()=>[t(d,{name:"ele-Refresh"}),p(" 重置 ")]),_:1})]),_:1})]),_:1},8,["model"]),y("div",xe,[t(u,{type:"primary",plain:"",onClick:O},{default:l(()=>[t(d,{name:"ele-Plus"}),p("新增 ")]),_:1}),t(u,{type:"danger",plain:"",disabled:e.multiple,onClick:x},{default:l(()=>[t(d,{name:"ele-Delete"}),p("删除 ")]),_:1},8,["disabled"]),t(u,{type:"warning",plain:"",onClick:$},{default:l(()=>[t(d,{name:"ele-Download"}),p("导出 ")]),_:1})]),V((g(),q(W,{border:"",data:e.tableData,stripe:"",onSelectionChange:S,style:{width:"100%"}},{default:l(()=>[t(r,{type:"selection",width:"45",align:"center"}),t(r,{label:"用户编号",align:"center",key:"userId",prop:"userId"}),t(r,{label:"用户名",prop:"username","show-overflow-tooltip":""}),t(r,{label:"头像","show-overflow-tooltip":""},{default:l(o=>[t(A,{class:"system-user-photo",src:o.row.avatar?o.row.avatar:P(he)(o.row.username)},null,8,["src"])]),_:1}),t(r,{label:"用户性别",align:"center",prop:"sex",formatter:K}),t(r,{prop:"phone",label:"手机","show-overflow-tooltip":""}),t(r,{prop:"email",label:"邮箱","show-overflow-tooltip":""}),t(r,{label:"状态",align:"center",key:"status"},{default:l(o=>[t(H,{modelValue:o.row.status,"onUpdate:modelValue":h=>o.row.status=h,"active-value":"0","inactive-value":"1",onClick:h=>E(o.row)},null,8,["modelValue","onUpdate:modelValue","onClick"])]),_:1}),t(r,{prop:"createTime",label:"创建时间","show-overflow-tooltip":""}),t(r,{prop:"path",label:"操作",fixed:"right",width:"180"},{default:l(o=>[t(u,{type:"text",onClick:h=>z(o.row)},{default:l(()=>[t(d,{name:"ele-Edit"}),p("修改 ")]),_:2},1032,["onClick"]),t(u,{type:"text",onClick:h=>x(o.row)},{default:l(()=>[t(d,{name:"ele-Delete"}),p("删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[Y,e.loading]]),V(y("div",null,[t(Z),t(G,{background:"",total:e.total,"page-sizes":[10,20,30],"current-page":e.queryParams.pageNum,"page-size":e.queryParams.pageSize,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:T,onCurrentChange:M},null,8,["total","current-page","page-size"])],512),[[ue,e.total>0]])]),_:1})]),_:1})]),_:1}),t(me,{ref_key:"userFormRef",ref:v,title:e.title},null,8,["title"])])}}});const Je=ge(we,[["__scopeId","data-v-cb469376"]]);export{Je as default};
