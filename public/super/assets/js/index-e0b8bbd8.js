import{d as j,h as A,_ as O,$ as W,i as Z,Z as J,ag as i,aq as X,o as u,c as f,V as o,P as t,u as s,a9 as Y,T as m,Q as S,O as C,W as ee,a as c,U as D,F as x,a8 as V}from"./@vue-110897a1.js";import{l as oe,p as te}from"./index-5e2104fc.js";import"./pinia-cd41b998.js";import"./vue-router-17193735.js";import"./vue-i18n-c25bb36f.js";import"./@intlify-d9393dcf.js";import"./vue-cc729cf0.js";import"./js-cookie-edb2da2a.js";import"./@element-plus-ff880098.js";import"./nprogress-28073a82.js";import"./axios-28bc18a3.js";import"./element-plus-28d330eb.js";import"./lodash-es-21c98b27.js";import"./@vueuse-0a258a1c.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-816b3f93.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-72afddb3.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-432baded.js";import"./lodash-9a19cd29.js";import"./mitt-f7ef348c.js";import"./@wangeditor-231513dc.js";import"./vue-grid-layout-2853dde1.js";const ae={class:"container"},le={class:"gen-body"},ne={class:"margin-bottom"},ie={class:"dialog-footer"},se={class:"gen-body"},re=["innerHTML"],Ie=j({__name:"index",setup(de){const{proxy:b}=A(),e=O({isShowDialog:!1,isShowGenDialog:!1,msg:"",names:"",datas:[],loading:!0,ids:[],single:!0,multiple:!0,title:"",tableData:[],total:0,options:[{value:"diygw:tableandapi",label:"创建表相关Model、Controller、API等类"},{value:"diygw:table",label:"创建表相关Model、Controller等类"},{value:"diygw:model",label:"创建Model类"}],type:"diygw:tableandapi",queryParams:{pageNum:1,pageSize:10,name:void 0,comment:void 0,status:void 0},dictItemForm:[]}),{loading:k,multiple:P,tableData:q,total:v,queryParams:_}=W(e),r=()=>{e.loading=!0,oe("/sys/database",e.queryParams).then(l=>{e.tableData=l.rows,e.total=l.total,e.loading=!1})},z=()=>{e.queryParams.name=void 0,e.queryParams.comment=void 0,e.queryParams.status=void 0,r()},M=()=>te("/sys/database/generate",{names:e.names,type:e.type}).then(l=>{e.isShowGenDialog=!1,e.datas=l.data,e.isShowDialog=!0}),h=l=>{const n=l.name||e.ids;e.names=n,e.msg='是否确认生成表格编号为"'+n+'"的表格？如果已生成不会重复生成。',e.isShowGenDialog=!0},B=l=>{e.ids=l.map(n=>n.name),e.single=l.length!=1,e.multiple=!l.length},G=l=>{e.queryParams.pageSize=l,r()},N=l=>{e.queryParams.pageNum=l,r()};return Z(()=>{r(),b.mittBus.on("onEditPostModule",()=>{r()})}),J(()=>{b.mittBus.off("onEditPostModule")}),(l,n)=>{const T=i("el-input"),y=i("el-form-item"),g=i("SvgIcon"),p=i("el-button"),U=i("el-form"),I=i("el-col"),E=i("el-row"),d=i("el-table-column"),F=i("el-table"),L=i("el-divider"),Q=i("el-pagination"),R=i("el-card"),$=i("el-radio"),H=i("el-radio-group"),w=i("el-dialog"),K=X("loading");return u(),f("div",ae,[o(R,{shadow:"always"},{default:t(()=>[o(U,{model:s(_),ref:"queryForm",inline:!0,"label-width":"68px"},{default:t(()=>[o(y,{label:"表格名称",prop:"name"},{default:t(()=>[o(T,{placeholder:"请输入表格名称或备注模糊查询",clearable:"",onKeyup:Y(r,["enter"]),style:{width:"240px"},modelValue:s(_).name,"onUpdate:modelValue":n[0]||(n[0]=a=>s(_).name=a)},null,8,["modelValue"])]),_:1}),o(y,null,{default:t(()=>[o(p,{type:"primary",onClick:r},{default:t(()=>[o(g,{name:"ele-Search"}),m("搜索 ")]),_:1}),o(p,{onClick:z},{default:t(()=>[o(g,{name:"ele-Refresh"}),m(" 重置 ")]),_:1})]),_:1})]),_:1},8,["model"]),o(E,{gutter:10,class:"mb8"},{default:t(()=>[o(I,{span:1.5},{default:t(()=>[o(p,{type:"danger",plain:"",disabled:s(P),onClick:h},{default:t(()=>[o(g,{name:"ele-Download"}),m("生成 ")]),_:1},8,["disabled"])]),_:1})]),_:1}),S((u(),C(F,{border:"",data:s(q),onSelectionChange:B},{default:t(()=>[o(d,{type:"selection",align:"center"}),o(d,{prop:"name",label:"表名"}),o(d,{prop:"comment",label:"注释"}),o(d,{prop:"engine",label:"引擎"}),o(d,{prop:"collation",label:"字符集"}),o(d,{prop:"rows",label:"数据行数"}),o(d,{label:"操作",align:"center",fixed:"right",width:"280"},{default:t(a=>[o(p,{type:"text",icon:"el-icon-s-tools",onClick:me=>h(a.row)},{default:t(()=>[o(g,{name:"ele-Download"}),m("生成 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[K,s(k)]]),S(c("div",null,[o(L),o(Q,{background:"",total:s(v),"current-page":s(_).pageNum,"page-size":s(_).pageSize,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:G,onCurrentChange:N},null,8,["total","current-page","page-size"])],512),[[ee,s(v)>0]])]),_:1}),o(w,{modelValue:e.isShowGenDialog,"onUpdate:modelValue":n[3]||(n[3]=a=>e.isShowGenDialog=a),width:"600px","destroy-on-close":"",title:"生成内容",draggable:"",center:""},{footer:t(()=>[c("div",ie,[o(p,{onClick:n[2]||(n[2]=a=>e.isShowGenDialog=!1)},{default:t(()=>[m(" 取 消 ")]),_:1}),o(p,{type:"primary",onClick:M},{default:t(()=>[m(" 生成 ")]),_:1})])]),default:t(()=>[c("div",le,[c("div",ne,D(e.msg),1),o(y,{label:"生成类型",prop:"configType"},{default:t(()=>[o(H,{class:"flex align-start flex-direction-column",modelValue:e.type,"onUpdate:modelValue":n[1]||(n[1]=a=>e.type=a)},{default:t(()=>[(u(!0),f(x,null,V(e.options,a=>(u(),C($,{value:a.value,key:a.value,label:a.value},{default:t(()=>[m(D(a.label),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})])]),_:1},8,["modelValue"]),o(w,{modelValue:e.isShowDialog,"onUpdate:modelValue":n[4]||(n[4]=a=>e.isShowDialog=a),width:"600px","destroy-on-close":"",title:"提示信息",draggable:"",center:""},{default:t(()=>[c("div",se,[(u(!0),f(x,null,V(e.datas,a=>(u(),f("div",null,[c("div",{innerHTML:a},null,8,re)]))),256))])]),_:1},8,["modelValue"])])}}});export{Ie as default};
