import{d as A,h as W,e as Z,_ as G,f as J,i as X,Z as Y,ag as n,aq as ee,o as f,c as v,V as t,P as o,a as b,a9 as w,F as te,a8 as ae,O as P,T as u,Q as q,W as oe}from"./@vue-110897a1.js";import le from"./editModule-4e043e6b.js";import{l as C,j as ne,k as se,_ as re}from"./index-5e2104fc.js";import{E as ie,a as de}from"./element-plus-28d330eb.js";import"./pinia-cd41b998.js";import"./vue-router-17193735.js";import"./vue-i18n-c25bb36f.js";import"./@intlify-d9393dcf.js";import"./vue-cc729cf0.js";import"./js-cookie-edb2da2a.js";import"./@element-plus-ff880098.js";import"./nprogress-28073a82.js";import"./axios-28bc18a3.js";import"./lodash-9a19cd29.js";import"./mitt-f7ef348c.js";import"./@wangeditor-231513dc.js";import"./vue-grid-layout-2853dde1.js";import"./lodash-es-21c98b27.js";import"./@vueuse-0a258a1c.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-816b3f93.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-72afddb3.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-432baded.js";const pe={class:"system-user-container container"},ue={class:"head-container"},me={class:"head-container"},ce=A({__name:"index",setup(_e){const{proxy:m}=W(),y=Z(),e=G({tableData:[],total:0,loading:!1,postOptions:[],defaultProps:{children:"children",label:"deptName"},sexOptions:[],roleOptions:[],statusOptions:[],deptName:void 0,single:!0,multiple:!0,ids:[],title:"",deptOptions:void 0,queryParams:{pageNum:1,pageSize:10,username:void 0,phone:void 0,status:void 0,deptId:void 0}});J(()=>e.deptName,a=>{m.$refs.tree.filter(a)});const g=async()=>{e.loading=!0,C("/sys/database",e.queryParams).then(a=>{a.code!=200&&(e.loading=!1),e.tableData=a.rows,e.total=a.total,e.loading=!1})},k=a=>{e.ids=a.map(l=>l.userId),e.single=a.length!=1,e.multiple=!a.length},r=async()=>{e.queryParams.pageNum=1,await g()},V=async()=>{e.queryParams.pageNum=1,e.queryParams.pageSize=10,e.queryParams.username="",e.queryParams.phone="",e.queryParams.status="",e.queryParams.deptId=0,r()},N=a=>{e.title="添加用戶",y.value.openDialog(null)},D=a=>{e.title="修改用户",y.value.openDialog(a)},I=async()=>{C("/sys/dept",{}).then(a=>{e.deptOptions=ne(a.rows,"deptId","parentId","children")})},x=a=>{const l=a.userId||e.ids;ie({message:'是否确认删除用户编号为"'+l+'"的数据项?',title:"警告",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){return se("/sys/user",l).then(()=>{r(),de.success("删除成功")})})},O=a=>{e.queryParams.pageSize=a,r()},S=a=>{e.queryParams.pageNum=a,r()},z=(a,l)=>a?l.label.indexOf(a)!==-1:!0,B=a=>{e.queryParams.deptId=a.deptId,g(),e.queryParams.deptId=0},E=()=>{e.queryParams};return X(()=>{g(),I(),m.getDicts("sys_normal_disable").then(a=>{e.statusOptions=a.rows}),m.getDicts("sys_user_sex").then(a=>{e.sexOptions=a.rows}),m.mittBus.on("onEditUserModule",a=>{r()})}),Y(()=>{m.mittBus.off("onEditUserModule")}),(a,l)=>{const h=n("el-input"),U=n("el-tree"),c=n("el-col"),_=n("el-form-item"),T=n("el-option"),M=n("el-select"),d=n("SvgIcon"),p=n("el-button"),F=n("el-form"),i=n("el-table-column"),L=n("el-table"),K=n("el-divider"),Q=n("el-pagination"),R=n("el-row"),$=n("el-card"),j=ee("loading");return f(),v("div",pe,[t($,{shadow:"always"},{default:o(()=>[t(R,{gutter:20},{default:o(()=>[t(c,{span:4,xs:24},{default:o(()=>[b("div",ue,[t(h,{modelValue:e.deptName,"onUpdate:modelValue":l[0]||(l[0]=s=>e.deptName=s),placeholder:"请输入部门名称",clearable:"","prefix-icon":"el-icon-search",style:{"margin-bottom":"20px"}},null,8,["modelValue"])]),b("div",me,[t(U,{data:e.deptOptions,props:e.defaultProps,"node-key":"deptId","expand-on-click-node":!1,"filter-node-method":z,ref:"tree","default-expand-all":"",onNodeClick:B},null,8,["data","props"])])]),_:1}),t(c,{span:20,xs:24},{default:o(()=>[t(F,{model:e.queryParams,ref:"queryForm",inline:!0,"label-width":"78px"},{default:o(()=>[t(_,{label:"用户名称",prop:"username"},{default:o(()=>[t(h,{placeholder:"用户名称模糊查询",clearable:"",onKeyup:w(r,["enter"]),style:{width:"240px"},modelValue:e.queryParams.username,"onUpdate:modelValue":l[1]||(l[1]=s=>e.queryParams.username=s)},null,8,["modelValue"])]),_:1}),t(_,{label:"手机号码",prop:"phone"},{default:o(()=>[t(h,{modelValue:e.queryParams.phone,"onUpdate:modelValue":l[2]||(l[2]=s=>e.queryParams.phone=s),placeholder:"请输入手机号码",clearable:"",style:{width:"240px"},onKeyup:w(r,["enter"])},null,8,["modelValue"])]),_:1}),t(_,{label:"状态",prop:"status"},{default:o(()=>[t(M,{modelValue:e.queryParams.status,"onUpdate:modelValue":l[3]||(l[3]=s=>e.queryParams.status=s),placeholder:"用户状态",clearable:"",style:{width:"240px"}},{default:o(()=>[(f(!0),v(te,null,ae(e.statusOptions,s=>(f(),P(T,{key:s.dictValue,label:s.dictLabel,value:s.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(_,null,{default:o(()=>[t(p,{type:"primary",onClick:r},{default:o(()=>[t(d,{name:"ele-Search"}),u(" 搜索 ")]),_:1}),t(p,{onClick:V},{default:o(()=>[t(d,{name:"ele-Refresh"}),u(" 重置 ")]),_:1})]),_:1})]),_:1},8,["model"]),t(c,{span:1.5},{default:o(()=>[t(p,{type:"primary",plain:"",onClick:N},{default:o(()=>[t(d,{name:"ele-Plus"}),u("新增 ")]),_:1})]),_:1}),t(c,{span:1.5},{default:o(()=>[t(p,{type:"danger",plain:"",disabled:e.multiple,onClick:x},{default:o(()=>[t(d,{name:"ele-Delete"}),u("删除 ")]),_:1},8,["disabled"])]),_:1}),t(c,{span:1.5},{default:o(()=>[t(p,{type:"warning",plain:"",onClick:E},{default:o(()=>[t(d,{name:"ele-Download"}),u("导出 ")]),_:1})]),_:1}),q((f(),P(L,{data:e.tableData,stripe:"",onSelectionChange:k,style:{width:"100%"}},{default:o(()=>[t(i,{label:"表名",prop:"name"}),t(i,{prop:"engine",label:"引擎"}),t(i,{prop:"collation",label:"字符集"}),t(i,{prop:"rows",label:"数据行数"}),t(i,{prop:"indexLength",label:"索引大小"}),t(i,{prop:"comment",label:"注释"}),t(i,{prop:"updateTime",label:"创建时间"}),t(i,{prop:"path",label:"操作",width:"150"},{default:o(s=>[t(p,{type:"text",onClick:H=>D(s.row)},{default:o(()=>[t(d,{name:"ele-Edit"}),u("修改 ")]),_:2},1032,["onClick"]),t(p,{type:"text",onClick:H=>x(s.row)},{default:o(()=>[t(d,{name:"ele-Delete"}),u("删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[j,e.loading]]),q(b("div",null,[t(K),t(Q,{background:"",total:e.total,"page-sizes":[10,20,30],"current-page":e.queryParams.pageNum,"page-size":e.queryParams.pageSize,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:O,onCurrentChange:S},null,8,["total","current-page","page-size"])],512),[[oe,e.total>0]])]),_:1})]),_:1})]),_:1}),t(le,{ref_key:"userFormRef",ref:y,title:e.title},null,8,["title"])])}}});const Qe=re(ce,[["__scopeId","data-v-3c4a0643"]]);export{Qe as default};
